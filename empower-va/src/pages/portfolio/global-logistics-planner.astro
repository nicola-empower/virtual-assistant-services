---
export const prerender = true;
import MainLayout from "../../layouts/MainLayout.astro";
import {
    Plane,
    Map,
    Calendar,
    Coffee,
    AlertCircle,
    ArrowRight,
} from "lucide-react";
---

<MainLayout
    title="Global Logistics Planner | Empower VA Tools"
    description="A custom-built logistics dashboard designed to manage complex travel itineraries, expenses, and family handovers in one place."
>
    <main class="relative min-h-screen pt-24 bg-slate-50">
        <!-- STORY / CONTEXT SECTION -->
        <section class="max-w-4xl mx-auto px-6 py-12">
            <div
                class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-100/50 border border-blue-200 text-xs font-bold text-blue-800 uppercase tracking-wide mb-6"
            >
                <Plane className="w-4 h-4" />
                Live Tool Demo
            </div>

            <h1
                class="text-4xl md:text-5xl font-extrabold text-slate-900 mb-6 tracking-tight"
            >
                Global Logistics Planner
            </h1>

            <div class="prose prose-lg text-slate-600 mb-12">
                <p class="lead text-xl font-medium text-slate-800">
                    They say necessity is the mother of invention. This tool
                    wasn't built for a client initially; it was built for <em
                        >survival</em
                    >.
                </p>
                <p>
                    Managing a business is hard enough. Add in perimenopausal
                    brain fog, ADHD, and the chaos of "20 plates spinning" at
                    once, and a simple business trip can become a logistical
                    nightmare.
                </p>
                <p>
                    Standard calendars didn't cut it. I didn't want 10 different
                    notebooks. I needed <strong
                        >one single source of truth</strong
                    > that could handle:
                </p>
                <ul class="grid md:grid-cols-2 gap-4 list-none pl-0 my-8">
                    <li
                        class="flex items-start gap-3 bg-white p-4 rounded-lg border border-slate-200 shadow-sm"
                    >
                        <Map className="w-5 h-5 text-blue-500 shrink-0 mt-1" />
                        <span
                            ><strong>Complex Itineraries:</strong> multi-leg flights,
                            hotels, and meetings.</span
                        >
                    </li>
                    <li
                        class="flex items-start gap-3 bg-white p-4 rounded-lg border border-slate-200 shadow-sm"
                    >
                        <AlertCircle
                            className="w-5 h-5 text-red-500 shrink-0 mt-1"
                        />
                        <span
                            ><strong>Home Handovers:</strong> Where are the kids?
                            What do they need? (Don't call mum, she's flying!)</span
                        >
                    </li>
                    <li
                        class="flex items-start gap-3 bg-white p-4 rounded-lg border border-slate-200 shadow-sm"
                    >
                        <Coffee
                            className="w-5 h-5 text-amber-600 shrink-0 mt-1"
                        />
                        <span
                            ><strong>Mental Load:</strong> Packing lists, expense
                            tracking, and medication reminders.</span
                        >
                    </li>
                </ul>
                <p>
                    The version below was my own planner, reused for business
                    use and anonymised for confidentiality reasons, but the core
                    logic remains: <strong>Total Control in One View.</strong>
                </p>
            </div>
        </section>

        <!-- THE TOOL (Ported HTML/CSS) -->
        <section
            class="border-t border-slate-200 bg-slate-200/50 py-12 px-2 md:px-6"
        >
            <div
                class="max-w-6xl mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden border border-slate-300"
            >
                <!-- Tool Header -->
                <div class="bg-[#004d99] text-white p-6 text-center shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold font-sans m-0">
                        Project Dashboard Example
                    </h2>
                    <p class="opacity-80 text-sm mt-1">
                        Interactive Demo - Feel free to add expenses or modify
                        the packing list! (Any inputs will not be saved.)
                    </p>
                </div>

                <!-- Tool Navigation -->
                <div
                    class="bg-slate-800 p-2 flex flex-wrap justify-center gap-2"
                >
                    <a
                        href="#itinerary"
                        class="text-white hover:bg-[#00a896] px-4 py-2 rounded-md text-sm font-bold transition-colors no-underline"
                        >Itinerary</a
                    >
                    <a
                        href="#packing"
                        class="text-white hover:bg-[#00a896] px-4 py-2 rounded-md text-sm font-bold transition-colors no-underline"
                        >Kit List</a
                    >
                    <a
                        href="#budget"
                        class="text-white hover:bg-[#00a896] px-4 py-2 rounded-md text-sm font-bold transition-colors no-underline"
                        >Budget</a
                    >
                    <a
                        href="#notes"
                        class="text-white hover:bg-[#00a896] px-4 py-2 rounded-md text-sm font-bold transition-colors no-underline"
                        >Delegated Tasks</a
                    >
                    <a
                        href="#documents"
                        class="text-white hover:bg-[#00a896] px-4 py-2 rounded-md text-sm font-bold transition-colors no-underline"
                        >Security & Docs</a
                    >
                </div>

                <!-- Tool Content Container -->
                <div
                    class="p-4 md:p-8 bg-[#f8f9fa] font-sans text-slate-800 tool-container"
                >
                    <!-- Dashboard -->
                    <div
                        class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm mb-8"
                    >
                        <h3
                            class="text-[#004d99] text-xl font-bold border-b-2 border-[#004d99] pb-2 mb-4"
                        >
                            Project Dashboard
                        </h3>
                        <div
                            id="nextEvent"
                            class="text-lg font-bold text-[#f94144] mb-4"
                        >
                            Loading next event...
                        </div>
                        <h4 class="text-md font-bold text-slate-700 mb-2">
                            Action Items (from Kit List):
                        </h4>
                        <ul
                            id="actionItemsList"
                            class="space-y-2 pl-0 list-none"
                        >
                            <!-- Populated by JS -->
                        </ul>
                    </div>

                    <!-- Add Event -->
                    <div
                        class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm mb-8"
                    >
                        <h3
                            class="text-[#004d99] text-xl font-bold border-b-2 border-[#004d99] pb-2 mb-4"
                        >
                            Add New Itinerary Event
                        </h3>
                        <form
                            id="addEventForm"
                            class="grid grid-cols-1 md:grid-cols-2 gap-4"
                        >
                            <div class="flex flex-col">
                                <label class="font-bold text-sm mb-1"
                                    >Date:</label
                                >
                                <input
                                    type="date"
                                    id="eventDate"
                                    required
                                    class="p-2 border border-slate-300 rounded"
                                />
                            </div>
                            <div class="flex flex-col">
                                <label class="font-bold text-sm mb-1"
                                    >Title:</label
                                >
                                <input
                                    type="text"
                                    id="eventTitle"
                                    placeholder="e.g., Meeting with CEO"
                                    required
                                    class="p-2 border border-slate-300 rounded"
                                />
                            </div>
                            <div class="flex flex-col">
                                <label class="font-bold text-sm mb-1"
                                    >Time (24h):</label
                                >
                                <input
                                    type="time"
                                    id="eventTime"
                                    required
                                    class="p-2 border border-slate-300 rounded"
                                />
                            </div>
                            <div class="flex flex-col md:col-span-2">
                                <label class="font-bold text-sm mb-1"
                                    >Description:</label
                                >
                                <input
                                    type="text"
                                    id="eventDescription"
                                    placeholder="e.g., Arrive at Louvre, Security Check..."
                                    required
                                    class="p-2 border border-slate-300 rounded"
                                />
                            </div>
                            <button
                                type="submit"
                                class="md:col-span-2 bg-[#004d99] text-white py-2 px-4 rounded font-bold hover:bg-[#00a896] transition-colors"
                                >Add Event to Itinerary</button
                            >
                        </form>
                    </div>

                    <!-- Itinerary -->
                    <section id="itinerary" class="mb-12">
                        <h3
                            class="text-[#004d99] text-2xl font-bold border-b-2 border-[#004d99] pb-2 mb-6"
                        >
                            Itinerary: Glasgow to Istanbul
                        </h3>
                        <div id="itinerary-list" class="space-y-4">
                            <!-- Populated by JS -->
                        </div>
                    </section>

                    <!-- Packing -->
                    <section
                        id="packing"
                        class="mb-12 bg-white p-6 rounded-xl border border-slate-200 shadow-sm"
                    >
                        <h3
                            class="text-[#004d99] text-2xl font-bold border-b-2 border-[#004d99] pb-2 mb-6"
                        >
                            Essential Kit List (Assets & Tech)
                        </h3>
                        <form id="addPackingItemForm" class="flex gap-4 mb-6">
                            <input
                                type="text"
                                id="newPackingItem"
                                placeholder="e.g., Presentation Clicker"
                                required
                                class="flex-1 p-2 border border-slate-300 rounded"
                            />
                            <button
                                type="submit"
                                class="bg-[#004d99] text-white py-2 px-4 rounded font-bold hover:bg-[#00a896] transition-colors"
                                >Add</button
                            >
                        </form>
                        <div id="packing-checklist" class="space-y-3">
                            <!-- Populated by JS -->
                        </div>
                        <p class="mt-4 text-[#f94144] font-bold text-sm">
                            *Remember to check power adapter requirements!
                        </p>
                    </section>

                    <!-- Budget -->
                    <section
                        id="budget"
                        class="mb-12 bg-white p-6 rounded-xl border border-slate-200 shadow-sm"
                    >
                        <h3
                            class="text-[#004d99] text-2xl font-bold border-b-2 border-[#004d99] pb-2 mb-6"
                        >
                            Project Budget Tracker
                        </h3>
                        <div class="mb-6 p-4 bg-slate-100 rounded-lg">
                            <p class="mb-2">
                                <strong>Total Fixed Costs:</strong>
                                <span id="totalFixedCost">£0.00</span>
                            </p>
                            <p>
                                <strong>Total Variable (Per Diem):</strong>
                                <span id="totalVariableSpending">£0.00</span>
                            </p>
                        </div>

                        <h4 class="font-bold mb-4">Add New Expense:</h4>
                        <form
                            id="addExpenseForm"
                            class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"
                        >
                            <input
                                type="text"
                                id="expenseDescription"
                                placeholder="Description"
                                required
                                class="p-2 border border-slate-300 rounded"
                            />
                            <input
                                type="number"
                                id="expenseAmount"
                                step="0.01"
                                min="0"
                                placeholder="Amount (£)"
                                required
                                class="p-2 border border-slate-300 rounded"
                            />
                            <select
                                id="expenseCategory"
                                required
                                class="p-2 border border-slate-300 rounded"
                            >
                                <option value="">Select Category</option>
                                <option value="fixed">Fixed Cost</option>
                                <option value="meals">Meals & Drinks</option>
                                <option value="shopping"
                                    >Supplies / Gifts</option
                                >
                                <option value="transport">Transport</option>
                            </select>
                            <button
                                type="submit"
                                class="md:col-span-3 bg-[#004d99] text-white py-2 px-4 rounded font-bold hover:bg-[#00a896] transition-colors"
                                >Add Expense</button
                            >
                        </form>

                        <div id="expense-list" class="space-y-2">
                            <!-- Populated by JS -->
                        </div>
                    </section>

                    <!-- Notes / Delegated -->
                    <section
                        id="notes"
                        class="mb-12 bg-white p-6 rounded-xl border border-slate-200 shadow-sm"
                    >
                        <h3
                            class="text-[#004d99] text-2xl font-bold border-b-2 border-[#004d99] pb-2 mb-6"
                        >
                            Delegated Tasks & Handoff
                        </h3>

                        <div class="mb-8">
                            <label class="block font-bold mb-2"
                                >Office/Internal Notes:</label
                            >
                            <textarea
                                id="generalNotes"
                                class="w-full p-3 border border-slate-300 rounded h-24 mb-2"
                            ></textarea>
                            <button
                                id="saveNotes"
                                class="bg-[#004d99] text-white py-1 px-3 rounded text-sm hover:bg-[#00a896] transition-colors"
                                >Save Notes</button
                            >
                        </div>

                        <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <h4 class="font-bold mb-4 text-lg">
                                    Office Contact Handoff
                                </h4>
                                <div class="space-y-4">
                                    <div>
                                        <label
                                            class="block text-sm font-bold mb-1"
                                            >Emergency Contract:</label
                                        >
                                        <input
                                            type="text"
                                            id="carerContact"
                                            class="w-full p-2 border border-slate-300 rounded"
                                        />
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-bold mb-1"
                                            >Key Login/Access:</label
                                        >
                                        <textarea
                                            id="kidsAllergies"
                                            class="w-full p-2 border border-slate-300 rounded h-20"
                                        ></textarea>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-bold mb-4 text-lg">
                                    Backup Procedures
                                </h4>
                                <div class="space-y-4">
                                    <div>
                                        <label
                                            class="block text-sm font-bold mb-1"
                                            >Server Failure:</label
                                        >
                                        <input
                                            type="text"
                                            id="mealFriday"
                                            class="w-full p-2 border border-slate-300 rounded"
                                        />
                                    </div>
                                    <div>
                                        <label
                                            class="block text-sm font-bold mb-1"
                                            >Comms Failure:</label
                                        >
                                        <input
                                            type="text"
                                            id="mealSaturday"
                                            class="w-full p-2 border border-slate-300 rounded"
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button
                            id="saveKiddoInfo"
                            class="mt-6 bg-[#004d99] text-white py-2 px-4 rounded font-bold hover:bg-[#00a896] transition-colors w-full md:w-auto"
                            >Save Handoff Details</button
                        >
                    </section>

                    <!-- Documents -->
                    <section
                        id="documents"
                        class="mb-12 bg-white p-6 rounded-xl border border-slate-200 shadow-sm"
                    >
                        <h3
                            class="text-[#004d99] text-2xl font-bold border-b-2 border-[#004d99] pb-2 mb-6"
                        >
                            Security & Documents
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-bold mb-1"
                                    >Passport/Visa:</label
                                >
                                <input
                                    type="text"
                                    id="passportNumber"
                                    class="w-full p-2 border border-slate-300 rounded"
                                />
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-1"
                                    >Expiry:</label
                                >
                                <input
                                    type="date"
                                    id="passportExpiry"
                                    class="w-full p-2 border border-slate-300 rounded"
                                />
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold mb-1"
                                    >Travel Insurance:</label
                                >
                                <textarea
                                    id="travelInsurance"
                                    class="w-full p-2 border border-slate-300 rounded h-16"
                                ></textarea>
                            </div>
                        </div>
                        <button
                            id="saveDocuments"
                            class="bg-[#004d99] text-white py-2 px-4 rounded font-bold hover:bg-[#00a896] transition-colors"
                            >Save Documents</button
                        >
                    </section>

                    <div class="text-center mt-12 text-slate-400 text-sm">
                        <p>
                            © 2025 Global Logistics Planner Demo. Built by
                            Empower Digital Solutions.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- CALL TO ACTION -->
        <section class="py-20 bg-white text-center">
            <div class="max-w-4xl mx-auto px-6">
                <h2 class="text-3xl font-bold text-slate-900 mb-6">
                    Need this kind of organisation?
                </h2>
                <p class="text-lg text-slate-600 mb-8 max-w-2xl mx-auto">
                    Whether it's a multi-city roadshow or just keeping your
                    sanity intact, I build systems that work for <em>your</em> brain.
                </p>
                <a
                    href="/contact"
                    class="inline-flex items-center gap-2 px-8 py-3 bg-teal-600 text-white font-bold rounded-lg hover:bg-teal-700 transition-colors"
                >
                    Let's Get Organised <ArrowRight className="w-5 h-5" />
                </a>
            </div>
        </section>
    </main>
</MainLayout>

<script is:inline>
    // --- Global Data Object ---
    let travelData = {};

    // --- Data Initialization ---
    function initializeDefaultData() {
        travelData = {
            itinerary: [
                {
                    type: "travel",
                    date: "2026-03-10",
                    title: "Departure: Glasgow to Berlin",
                    details: [
                        {
                            time: "06:00",
                            description: "Depart Home (Car to Glasgow Airport)",
                        },
                        {
                            time: "06:45",
                            description: "Arrive GLA - Check-in & Security",
                        },
                    ],
                    flight: {
                        number: "BA1473",
                        airline: "British Airways",
                        departure: "Glasgow (GLA) 08:30",
                        arrival: "London (LHR) 09:55",
                        confirmation: "GLA99B",
                        notes: "Connection at LHR T5.",
                    },
                    flights_connecting: [
                        {
                            number: "BA984",
                            airline: "British Airways",
                            departure: "London (LHR) 11:25",
                            arrival: "Berlin (BER) 14:15",
                            confirmation: "BER44A",
                            notes: "Business Class, Seat 2A.",
                        },
                    ],
                    return_home: [
                        {
                            time: "15:00",
                            description: "Taxi from BER to Hotel",
                        },
                        {
                            time: "15:45",
                            description:
                                "Check-in: Grand Hyatt Berlin (Conf: 99827-B)",
                        },
                    ],
                },
                {
                    type: "activity",
                    date: "2026-03-11",
                    title: "Berlin Conference & Travel to Paris",
                    details: [
                        {
                            time: "09:00",
                            description:
                                "Keynote Speech: Berlin Tech Conference",
                        },
                        { time: "12:00", description: "Networking Lunch" },
                        {
                            time: "14:00",
                            description: "Depart Hotel (Taxi to BER)",
                        },
                    ],
                    flight: {
                        number: "AF1135",
                        airline: "Air France",
                        departure: "Berlin (BER) 16:30",
                        arrival: "Paris (CDG) 18:20",
                        confirmation: "PAR22C",
                        notes: "Seat 5F. Prepare Louvre brief on flight.",
                    },
                    return_home: [
                        {
                            time: "19:00",
                            description: "Taxi from CDG to Hotel",
                        },
                        {
                            time: "19:45",
                            description:
                                "Check-in: Hotel Regina Louvre (Conf: 88162-P)",
                        },
                    ],
                },
            ],
            packingList: [
                { item: "Laptop & Charger", packed: false, category: "tech" },
                {
                    item: "Conference Presentation (USB)",
                    packed: false,
                    category: "tech",
                },
                {
                    item: "Louvre Security Brief (Printed)",
                    packed: false,
                    category: "documents",
                },
                {
                    item: "International Power Adapters (EU & TR)",
                    packed: false,
                    category: "tech",
                },
                {
                    item: "Business Suits (2x)",
                    packed: false,
                    category: "attire",
                },
            ],
            budget: {
                fixedCosts: [
                    {
                        description: "Multi-City Flights",
                        amount: 2450.0,
                        date: "2026-01-15",
                    },
                    {
                        description: "Berlin Tech Conference Pass",
                        amount: 800.0,
                        date: "2026-01-20",
                    },
                ],
                expenses: [],
            },
            notes: {
                general:
                    "Need to confirm AV setup details with Berlin team. Backup presentation on USB.",
                souvenirs: [],
                kiddoInfo: {
                    carerContact:
                        "Jane Smith (Office Manager), +44-20-7946-0958",
                    allergies: "VPN Login: [redacted]",
                    routine: "Server check Friday 5pm GMT.",
                    meals: {
                        friday: "Switch to backup server",
                        saturday: "Use encrypted chat channel",
                        sunday: "",
                    },
                },
                documentsAndLinks: {
                    passportNumber: "GBR-987654321",
                    passportExpiry: "2030-05-20",
                    travelInsurance: "Policy: GLOBAL-CORP-99A.",
                    localEmergency: "EU (112)",
                    importantLinks: [],
                },
            },
        };
    }

    // --- Helper Functions ---
    function showDemoAlert(message) {
        alert(`Demo Action: ${message}`);
    }

    function formatFullDate(isoDate) {
        const date = new Date(isoDate + "T00:00:00");
        const options = {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
        };
        return new Intl.DateTimeFormat("en-GB", options).format(date);
    }

    // --- Rendering Functions ---
    function renderAndBind() {
        const itineraryList = document.getElementById("itinerary-list");
        const packingChecklist = document.getElementById("packing-checklist");
        const nextEventDiv = document.getElementById("nextEvent");
        const actionItemsList = document.getElementById("actionItemsList");
        const totalFixedCostSpan = document.getElementById("totalFixedCost");
        const totalVariableSpendingSpan = document.getElementById(
            "totalVariableSpending",
        );
        const expenseListDiv = document.getElementById("expense-list");

        // Render Itinerary
        if (itineraryList) {
            itineraryList.innerHTML = "";
            travelData.itinerary.sort(
                (a, b) => new Date(a.date) - new Date(b.date),
            );
            travelData.itinerary.forEach((item) => {
                const itemDiv = document.createElement("div");
                itemDiv.className =
                    "bg-white border border-slate-200 p-4 rounded-lg shadow-sm";
                let content = `<h4 class="text-[#004d99] font-bold text-lg mb-2">${formatFullDate(item.date)} - ${item.title}</h4>`;

                if (item.details) {
                    item.details.forEach((detail) => {
                        content += `<p class="text-sm mb-1"><strong>${detail.time}:</strong> ${detail.description}</p>`;
                    });
                }
                if (item.flight) {
                    content += `<div class="mt-3 pt-3 border-t border-slate-100 text-sm bg-blue-50/50 p-2 rounded">
                        <p class="font-bold text-[#004d99]">✈️ ${item.flight.airline} ${item.flight.number}</p>
                        <p>${item.flight.departure} -> ${item.flight.arrival}</p>
                        <p class="text-xs text-slate-500 mt-1">Ref: ${item.flight.confirmation}</p>
                    </div>`;
                }
                itemDiv.innerHTML = content;
                itineraryList.appendChild(itemDiv);
            });
        }

        // Render Dashboard
        if (nextEventDiv) {
            const now = new Date("2026-03-09T00:00:00"); // Fake current date for demo

            // Find next event
            nextEventDiv.innerHTML = `Next Up: <span class="text-slate-800">Departure: Glasgow to Berlin (Tuesday, 10 March 2026)</span>`;

            // Action items
            if (actionItemsList) {
                actionItemsList.innerHTML = "";
                const unpacked = travelData.packingList.filter(
                    (i) => !i.packed,
                );
                if (unpacked.length === 0) {
                    actionItemsList.innerHTML =
                        '<li class="text-green-600 font-bold">All items packed!</li>';
                } else {
                    unpacked.slice(0, 3).forEach((item) => {
                        const li = document.createElement("li");
                        li.className =
                            "bg-orange-50 text-orange-800 px-2 py-1 rounded text-sm";
                        li.textContent = `Pack: ${item.item}`;
                        actionItemsList.appendChild(li);
                    });
                }
            }
        }

        // Render Packing
        if (packingChecklist) {
            packingChecklist.innerHTML = "";
            travelData.packingList.forEach((item, index) => {
                const div = document.createElement("div");
                div.className =
                    "flex items-center gap-3 bg-slate-50 p-2 rounded justify-between";

                const leftDiv = document.createElement("div");
                leftDiv.className = "flex items-center gap-3";

                const checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.checked = item.packed;
                checkbox.className = "w-5 h-5 accent-[#004d99]";
                checkbox.addEventListener("change", (e) => {
                    travelData.packingList[index].packed = e.target.checked;
                    renderAndBind();
                });

                const span = document.createElement("span");
                span.textContent = item.item;
                if (item.packed) {
                    span.className = "line-through text-slate-400";
                }

                const delBtn = document.createElement("button");
                delBtn.textContent = "×";
                delBtn.className =
                    "text-red-500 font-bold text-xl px-2 hover:bg-red-50 rounded";
                delBtn.addEventListener("click", () => {
                    travelData.packingList.splice(index, 1);
                    renderAndBind();
                });

                leftDiv.appendChild(checkbox);
                leftDiv.appendChild(span);
                div.appendChild(leftDiv);
                div.appendChild(delBtn);
                packingChecklist.appendChild(div);
            });
        }

        // Render Budget
        if (totalFixedCostSpan) {
            let totalFixed = 0;
            travelData.budget.fixedCosts.forEach(
                (c) => (totalFixed += c.amount),
            );
            totalFixedCostSpan.textContent = `£${totalFixed.toFixed(2)}`;

            let totalVar = 0;
            travelData.budget.expenses.forEach((c) => (totalVar += c.amount));
            totalVariableSpendingSpan.textContent = `£${totalVar.toFixed(2)}`;

            if (expenseListDiv) {
                expenseListDiv.innerHTML = "";
                const allExpenses = [
                    ...travelData.budget.fixedCosts.map((x) => ({
                        ...x,
                        type: "fixed",
                    })),
                    ...travelData.budget.expenses.map((x) => ({
                        ...x,
                        type: "var",
                    })),
                ];
                allExpenses.forEach((exp) => {
                    const div = document.createElement("div");
                    div.className =
                        "flex justify-between text-sm border-b border-slate-100 py-1";
                    div.innerHTML = `<span>${exp.description}</span> <span class="font-mono">£${exp.amount.toFixed(2)}</span>`;
                    expenseListDiv.appendChild(div);
                });
            }
        }

        // Render Inputs
        document.getElementById("generalNotes").value =
            travelData.notes.general;
        document.getElementById("carerContact").value =
            travelData.notes.kiddoInfo.carerContact;
        document.getElementById("kidsAllergies").value =
            travelData.notes.kiddoInfo.allergies;
        document.getElementById("mealFriday").value =
            travelData.notes.kiddoInfo.meals.friday;
        document.getElementById("mealSaturday").value =
            travelData.notes.kiddoInfo.meals.saturday;
        document.getElementById("passportNumber").value =
            travelData.notes.documentsAndLinks.passportNumber;
        document.getElementById("passportExpiry").value =
            travelData.notes.documentsAndLinks.passportExpiry;
        document.getElementById("travelInsurance").value =
            travelData.notes.documentsAndLinks.travelInsurance;
    }

    // --- Init ---
    document.addEventListener("DOMContentLoaded", () => {
        initializeDefaultData();
        renderAndBind();

        // Bind Forms
        document
            .getElementById("addEventForm")
            .addEventListener("submit", (e) => {
                e.preventDefault();
                const newEvent = {
                    type: "activity",
                    date: document.getElementById("eventDate").value,
                    title: document.getElementById("eventTitle").value,
                    details: [
                        {
                            time: document.getElementById("eventTime").value,
                            description:
                                document.getElementById("eventDescription")
                                    .value,
                        },
                    ],
                };
                travelData.itinerary.push(newEvent);
                showDemoAlert("Event added to itinerary!");
                renderAndBind();
                e.target.reset();
            });

        document
            .getElementById("addPackingItemForm")
            .addEventListener("submit", (e) => {
                e.preventDefault();
                const val = document.getElementById("newPackingItem").value;
                if (val) {
                    travelData.packingList.push({ item: val, packed: false });
                    renderAndBind();
                    document.getElementById("newPackingItem").value = "";
                }
            });

        document
            .getElementById("addExpenseForm")
            .addEventListener("submit", (e) => {
                e.preventDefault();
                const desc =
                    document.getElementById("expenseDescription").value;
                const amt = parseFloat(
                    document.getElementById("expenseAmount").value,
                );
                if (desc && amt) {
                    travelData.budget.expenses.push({
                        description: desc,
                        amount: amt,
                    });
                    renderAndBind();
                    e.target.reset();
                }
            });

        const saveBtns = ["saveNotes", "saveKiddoInfo", "saveDocuments"];
        saveBtns.forEach((id) => {
            document.getElementById(id).addEventListener("click", () => {
                showDemoAlert("Data saved to local state (Demo Mode)");
            });
        });
    });
</script>
